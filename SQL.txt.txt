--1- Devuelve todas las películas
 SELECT MOVIE_NAME FROM MOVIES m

--2- Devuelve todos los géneros existentes
 SELECT GENRE_NAME FROM GENRES g 
 
--3- Devuelve la lista de todos los estudios de grabación que estén activos
 SELECT * FROM STUDIOS s WHERE STUDIO_ACTIVE = 1

 --4- Devuelve una lista de los 20 últimos miembros en anotarse a la plataforma
 SELECT * FROM USERS ORDER BY user_join_date DESC LIMIT 20

-- 5- Devuelve las 20 duraciones de películas más frecuentes, ordenados de mayor a menor
SELECT m.MOVIE_DURATION FROM MOVIES m ORDER BY m.MOVIE_DURATION DESC LIMIT 20
 
-- 6- Devuelve las películas del año 2000 en adelante que empiecen por la letra A.
 6 SELECT * FROM (SELECT *FROM movies WHERE movie_release_date >= '2000-01-01') WHERE movie_name LIKE 'A%';

-- 7- Devuelve los actores nacidos un mes de Junio
SELECT * FROM ACTORS a WHERE MONTH (a.ACTOR_BIRTH_DATE) = 6

-- 8- Devuelve los actores nacidos cualquier mes que no sea Junio y que sigan vivos
SELECT * FROM ACTORS a WHERE MONTH (a.ACTOR_BIRTH_DATE) <> 6 AND a.ACTOR_DEAD_DATE IS NULL

-- 9- Devuelve el nombre y la edad de todos los directores menores o iguales de 50 años que estén vivos
SELECT DIRECTOR_NAME, director_birth_date FROM DIRECTORS WHERE DIRECTOR_birth_date >= '1975-10-09' AND DIRECTOR_DEAD_DATE IS NULL

-- 10- Devuelve el nombre y la edad de todos los actores menores de 50 años que hayan fallecido
SELECT actor_name, actor_birth_date FROM actors WHERE actor_birth_date > '1975-10-09'AND actor_dead_date IS NOT NULL

-- 11- Devuelve el nombre de todos los directores menores o iguales de 40 años que estén vivos
SELECT actor_name FROM actors WHERE actor_birth_date >= '1985-10-09' AND actor_dead_date IS NULL

--12.- Indica la edad media de los directores vivos
SELECT AVG(YEAR(CURRENT_DATE) - YEAR(DIRECTOR_BIRTH_DATE)) AS EDADMEDIA FROM DIRECTORS WHERE DIRECTOR_DEAD_DATE IS NULL;

--13.- Indica la edad media de los actores que han fallecido
SELECT AVG(YEAR(DIRECTOR_DEAD_DATE) - YEAR(DIRECTOR_BIRTH_DATE)) AS EDADMEDIA FROM DIRECTORS WHERE DIRECTOR_DEAD_DATE IS NOT NULL;

--14.- Devuelve el nombre de todas las películas y el nombre del estudio que las ha realizado
SELECT m.MOVIE_NAME, s.STUDIO_NAME FROM MOVIES m INNER JOIN STUDIOS s ON m.STUDIO_ID = s.STUDIO_ID;

--15.- Devuelve los miembros que accedieron al menos una película entre el año 2010 y el 2015
SELECT USER_NAME 
FROM USERS u INNER JOIN USER_MOVIE_ACCESS uma ON u.USER_ID = uma.USER_ID WHERE YEAR(uma.ACCESS_DATE) >= 2010 AND YEAR(uma.ACCESS_DATE) <= 2015;

--16.- Devuelve cuántas películas hay de cada país
SELECT n.NATIONALITY_NAME, COUNT(n.NATIONALITY_ID) FROM MOVIES m INNER JOIN NATIONALITIES n ON m.NATIONALITY_ID = n.NATIONALITY_ID GROUP BY n.NATIONALITY_NAME;

--17.- Devuelve todas las películas que hay de tipo “Documentary”
SELECT m.MOVIE_NAME FROM MOVIES m INNER JOIN GENRES g ON m.GENRE_ID = g.GENRE_ID WHERE g.GENRE_NAME = 'Documentary';

--18.- Devuelve todas las películas creadas por directores nacidos a partir de 1980 y que todavía están vivos
SELECT m.MOVIE_NAME FROM MOVIES m INNER JOIN DIRECTORS d ON m.DIRECTOR_ID = d.DIRECTOR_ID WHERE YEAR(d.DIRECTOR_BIRTH_DATE) > 1980 AND d.DIRECTOR_DEAD_DATE IS NULL;

--19.- Indica si hay alguna coincidencia en nacimiento de ciudad y si las hay, indícalas entre los miembros de la plataforma y los directores
SELECT u.USER_NAME AS usuario, d.DIRECTOR_NAME AS director, u.USER_TOWN AS coincidencia FROM USERS u INNER JOIN DIRECTORS d ON u.USER_TOWN = d.DIRECTOR_BIRTH_PLACE;

--20.- Devuelve el nombre y el año de todas las películas que han sido producidas por un estudio que actualmente no está activo
SELECT m.MOVIE_NAME, YEAR(m.MOVIE_RELEASE_DATE) AS AÑO FROM MOVIES m INNER JOIN STUDIOS s ON m.STUDIO_ID = s.STUDIO_ID WHERE s.STUDIO_ACTIVE = 0;

-- 21.- Devuelve una lista de las últimas 10 películas a las que se ha accedido
SELECT MOVIE_ID FROM USER_MOVIE_ACCESS ORDER BY ACCESS_DATE DESC LIMIT 10;

-- 22- Indica cuántas películas ha realizado cada director antes de cumplir 41 años
SELECT d.director_id, d.director_name, COUNT(m.movie_name) AS peliculas_antes_de41 FROM movies m JOIN directors d ON m.director_id = d.director_id WHERE (julianday(m.movie_release_date) - julianday(d.director_birth_day)) / 365 < 41 GROUP BY d.director_id, d.director_name;

-- 23- Indica cuál es la media de duración de las películas de cada director
SELECT d.DIRECTOR_NAME, AVG(m.MOVIE_DURATION) FROM DIRECTORS d INNER JOIN MOVIES m ON d.DIRECTOR_ID = m.DIRECTOR_ID GROUP BY d.DIRECTOR_NAME;

-- 24- Indica cuál es la el nombre y la duración mínima de las películas a las que se ha accedido en los últimos 2 años por los miembros del plataforma (La “fecha de ejecución” de esta consulta es el 25-01-2019)
SELECT m.MOVIE_DURATION, m.MOVIE_NAME FROM MOVIES m INNER JOIN USER_MOVIE_ACCESS u ON m.MOVIE_ID = u.MOVIE_ID WHERE u.ACCESS_DATE BETWEEN '2017-01-25' AND '2019-01-25';

-- 25- Indica el número de películas que hayan hecho los directores durante las décadas de los 60, 70 y 80 que contengan la palabra “The” en cualquier par